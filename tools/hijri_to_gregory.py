import datetime as dt

def hijmonth_length(year, month, day=1):
    year = int(year)
    month = int(month)
    day = int(day)
    
    leap_years = [1350, 1354, 1358, 1362, 1366, 1370, 1375, 1379, 1383, 1387, 1391, 1395, 1399, 1403, 1408, 1412, 
              1416, 1420, 1424, 1428, 1432, 1436, 1441, 1445, 1449, 1453, 1457, 1461, 1465, 1469, 1474, 1478,
              1482, 1486, 1490, 1494, 1498, 1502, 1507, 1511, 1515, 1519, 1523, 1527, 1531, 1535, 1540, 1544,
              1548, 1552, 1556, 1560, 1564, 1568, 1573, 1577, 1581, 1585, 1589, 1593, 1597, 1601, 1606, 1610,
              1614, 1618, 1622, 1626, 1630, 1635, 1639, 1643, 1647, 1651, 1655, 1659, 1663, 1668, 1672, 1676,
              1680, 1684, 1688, 1692, 1696]
    
    if (year < 1349) or (year > 1699):
        return 'error'
    if month < 1 or month > 12:
        return 'error'
    if day < 1 or day > 31:
        return 'error'
    if month > 6 and day > 30:
        return 'error'
    if month == 12 and year not in leap_years and day > 29:
        return 'error'
    
    if month < 7:
        return 31
    if 6 < month < 12:
        return 30
    if month == 12 and year not in leap_years:
        return 29
    if month == 12 and year in leap_years:
        return 30



def hij_to_greg(year, month, day):
    days_of_previous_years = [0, 365, 731, 1096, 1461, 1826, 2192, 2557, 2922, 3287, 3653, 4018, 4383, 4748,
                          5114, 5479, 5844, 6209, 6575, 6940, 7305, 7670, 8036, 8401, 8766, 9131, 9496,
                          9862, 10227, 10592, 10957, 11323, 11688, 12053, 12418, 12784, 13149, 13514,
                          13879, 14245, 14610, 14975, 15340, 15706, 16071, 16436, 16801, 17167, 17532,
                          17897, 18262, 18628, 18993, 19358, 19723, 20089, 20454, 20819, 21184, 21549,
                          21915, 22280, 22645, 23010, 23376, 23741, 24106, 24471, 24837, 25202, 25567,
                          25932, 26298, 26663, 27028, 27393, 27759, 28124, 28489, 28854, 29220, 29585,
                          29950, 30315, 30681, 31046, 31411, 31776, 32142, 32507, 32872, 33237, 33602,
                          33968, 34333, 34698, 35063, 35429, 35794, 36159, 36524, 36890, 37255, 37620,
                          37985, 38351, 38716, 39081, 39446, 39812, 40177, 40542, 40907, 41273, 41638,
                          42003, 42368, 42734, 43099, 43464, 43829, 44195, 44560, 44925, 45290, 45655,
                          46021, 46386, 46751, 47116, 47482, 47847, 48212, 48577, 48943, 49308, 49673,
                          50038, 50404, 50769, 51134, 51499, 51865, 52230, 52595, 52960, 53326, 53691,
                          54056, 54421, 54787, 55152, 55517, 55882, 56248, 56613, 56978, 57343, 57708,
                          58074, 58439, 58804, 59169, 59535, 59900, 60265, 60630, 60996, 61361, 61726,
                          62091, 62457, 62822, 63187, 63552, 63918, 64283, 64648, 65013, 65379, 65744,
                          66109, 66474, 66840, 67205, 67570, 67935, 68301, 68666, 69031, 69396, 69761,
                          70127, 70492, 70857, 71222, 71588, 71953, 72318, 72683, 73049, 73414, 73779,
                          74144, 74510, 74875, 75240, 75605, 75971, 76336, 76701, 77066, 77432, 77797,
                          78162, 78527, 78893, 79258, 79623, 79988, 80354, 80719, 81084, 81449, 81814,
                          82180, 82545, 82910, 83275, 83641, 84006, 84371, 84736, 85102, 85467, 85832,
                          86197, 86563, 86928, 87293, 87658, 88024, 88389, 88754, 89119, 89485, 89850,
                          90215, 90580, 90946, 91311, 91676, 92041, 92407, 92772, 93137, 93502, 93867,
                          94233, 94598, 94963, 95328, 95694, 96059, 96424, 96789, 97155, 97520, 97885,
                          98250, 98616, 98981, 99346, 99711, 100077, 100442, 100807, 101172, 101538,
                          101903, 102268, 102633, 102999, 103364, 103729, 104094, 104459, 104825,
                          105190, 105555, 105920, 106286, 106651, 107016, 107381, 107747, 108112,
                          108477, 108842, 109208, 109573, 109938, 110303, 110669, 111034, 111399,
                          111764, 112130, 112495, 112860, 113225, 113591, 113956, 114321, 114686,
                          115052, 115417, 115782, 116147, 116512, 116878, 117243, 117608, 117973,
                          118339, 118704, 119069, 119434, 119800, 120165, 120530, 120895, 121261,
                          121626, 121991, 122356, 122722, 123087, 123452, 123817, 124183, 124548,
                          124913, 125278, 125644, 126009, 126374, 126739, 127105, 127470, 127835]
    days_of_previous_months = ['', 0, 31, 62, 93, 124, 155, 186, 216, 246, 276, 306, 336]
    
    # equal to 1349.1.1
    BASE_DAY = dt.date(1970, 3, 21)
    if hijmonth_length(year, month, day) == 'error':
        return 'error'
    else:
        passed_days = days_of_previous_years[year-1349] + days_of_previous_months[month] + day - 1
        return BASE_DAY + dt.timedelta(days=passed_days)
    